# 음성합성 기술의 종류

음성합성은 크게 4가지로 나누어 분류한다.

* 연결합성
* 통계기반 파라메터 합성
* 조음합성
* 포먼트 합성



## 연결합성

연결합성은 USS(Unit Selection Synthesis) 라고 부르기도 하는데 이름을 주의깊게 살펴보면 어떤 기술인지 가늠 할수 있다.

사실 이름에서 이미 연결합성의 주요 기술들이 드러나고 있다.

이름속의 unit이라는 것은 음성 녹음 데이터를 어떤 기준에 의해서 잘게 쪼갠 데이터, 즉 음편을 말한다. Unit selection 이라는 것은 그렇게 잘게 쪼갠 음편(unit)들중 가장 적합한 음편을 선택(selection)한다는 의미다. 만들고자 하는 음성을 가장 잘 표현할 수 있는 음편을 어떤 알고리즘에 의해 선택하게 되고 어떻게 선택된 음편들을 서로 이어붙이면(concatenation) 음성이 된다.

이렇게 음편을 서로 이어 붙인다는 의미가 연결합성이라 한다.

**연결합성은 실제 음성을 잘게 쪼갠 음편들을 이어 붙이므로, 현존하는 음성합성 기술중 가장 음질이 좋다**

**(원음으로 만들어진 음편을 이어 붙이기 때문)**

* 하지만 이어 붙이는 과정에서 운율의 부조화가 나타날수 있다는 단점이 있음

* 구글에서 발표한 tacotron2 는 WaveNet vocoder를 적용하면서 연결합성 기술을 넘어서는 뛰어난 음질과 자연성을 보여주고 있다.

![image-20200206151248063](C:\Users\s_m04\AppData\Roaming\Typora\typora-user-images\image-20200206151248063.png)



## 통계기반 파라메터 합성

통계기반 파라메터 합성 기술은 음성 신호처리 기술에 기반한 것이다. 음성은 조음기관을 거치는 과정에서 어떤 특성을 가지게 되는데 이 특성을 신호처리 기술을 활용하여 음성 데이터로 부터 추출하고, 그것을 모델링 한 것이다. 음성 데이터로 부터 추출된 이러한 음성 특징들을 파라메터라고 부른다.



통계기반 파라메터 합성은 음성 특징 파라메터들을 추출하여 통계기반으로 모델링 하는 훈련과정과, 텍스트가 입력되면 통계 모델로부터 해당하는 파라메터를 생성하여 신호처리를 통하여 음성으로 만들어내는 합성 과정으로 구성된다.

![image-20200206151822548](../../../../AppData/Roaming/Typora/typora-user-images/image-20200206151822548.png)



위 그림에서 Training part 를 보면 음성으로 부터 'Excitation parameter' 와 'spectral parameter'를 추출한다. 이것은 각각 음성에 대한 기본 주파수 성분 f0와 주파수 대역별 power spectrum을 mel scale로 추출하여 특징화한 파라메터이다. 이렇게 추출한 파라메터는 언제든지 음성으로 복원할수 있는 정보를 담고 있으므로 음성 데이터 그 자체라고 할수 있다. 통계기반 파라메터 합성기는 이러한 파라메터들을 통계적으로 모델링하고 다시 가져와서 음성으로 만들어 내는 과정이다.

그렇다면 음성데이터 자체를 모델링하지 않고 이와 같이 파라메터를 추출하여 모델링하는 이유가 무엇인지 의문이 생길 것이다. 음성데이터는 시간축에 따라 음성의 크기만 가지고 있다. 해당 음성의 운율정보나 피치등의 중요한 특징정보를 알아낼수 없다. 즉, 음성의 특징정보가 너무 부족하다.

음성의 중요한 특징정보를 담고있는 파라메터는 통계기반 파라메터 합성기에서 매우 중요한 핵심요소이다. 통계기반 파라메터합성기를 잘 이해 하기 위해서는 파라메터에 대하여 조금 더 자세히 알 필요가 있다. 

파라메터라고 하는 것은 사람의 음성을 신호 관점에서 볼때, 음성이 가지는 특성들을 말하는 것이다.



사람들은 자기만의 고유한 조음기관을 가지고 있다. 모든 사람들의 외모가 서로 다르듯이 사람들이 가지고 있는 조음기관도 서로 다르다.  음성 파라메터에서는 pitch, duration, 음색, 음의 세기 등 기타 요소로 결정된다.



* 음성 톤의 높낮이를 나타내는 피치

  먼저 여성과 남성, 아이와 어른의 목소리를 구분할 수 있는 특징점은 '톤'이다. 여성과 아이는 톤이 높고, 남성은 톤이 낮다. 이것을 '피치' 라고 한다. 피치를 결정하는 것은 앞에서 설명한 포먼트 정보이다. 피치가 높다는 것은 제1 포먼트(f0)가 높은쪽에 위치하고 피치가 낮다는 것은 낮은 쪽에 위치한다. 스펙트 로그램의 가장 아래쪽에 나타나는 진한 갈비뼈 모양이 위쪽에 있으면 톤이 높고, 낮은쪽에 있으면 톤이 낮다. 그러므로 여성과 아이들은 제 1 포먼트(f0)의 위치가 높은쪽에 나타날것이라는 것을 눈치 챌수가 있을 것이다. 이제 우리는 음성을 듣지 않고, 스펙트로그램만 보고도 여성의 음성인지 남성의 음성인지 정도는 판단 할수 있는 능력이 생겼다. 일반적으로 성인 남성은 85~155 hz, 성인 여성은 165~255hz의 f0를 가진다. 이렇게 목소리 톤이 높고 낮음을 결정하는 특성을 '피치'라고 한다.

* 음성의 길이(duration)

  ​	말하는 속도는 사람마다 제 각각이다. 느릿느릿 말하는 사람, 속사포처럼 	말하는 사람, 말하는 습관에 따라 특정 단어를 느리게 또는 빠르게, 세게 또 	는 약하게 발성하기도 한다. 따라서 음성의 특성을 결정하는데 음의 길이는 	매우 중요한 요소중 하나이다. 만약 어떤 사람이 "오늘 날씨가 좋네요" 라는 	말을 한다고 가정해보자. 약하게 천천히 발성하면. 슬픈 느낌이 난다. 또 빠	르고 힘있게 발성하면 기쁜 느낌이 난다. 이와 같이 음의 길이는 음성의 감	성을 결정하는데 중요한 요소중 하나이다.

*  음색, 음의 세기 등 기타요소들

  ​	음성의 특성을 결정하는데 있어서 가장 중요한 요소는 피치와 길이이다. 그외 음의 크기나 음의세기 등도 중요한 요소중 하나인데, 이러한 요소들은 MFCC라는 특징값으로 신호처리 기술을 이용하여 추출할 수 있다. MFCC는 음성인식에서도 중요하게 사용하는 음성의 스펙트로그램 특징정보를 담고 있다.



위와 같은 음성의 특징 정보들을 파라메터라 부른다. 통계 기반 파라메터 합성기는 이러한 특징 파라메터들을 통계기반으로 모델링 하는 것이다. 이해를 쉽게하기 위하여 'ㄱ'이라는 음소에 대한 모델링을 살펴보자. '가'라는 음성의 'ㄱ','공'이라는 음성의 'ㄱ','구' 라는 음성의 'ㄱ'과 같이 음성데이터 내에 존재하는 모든 'ㄱ'들에 해당하는 음성으로 부터 파라메터들을 추출하여 비슷한 특성을 가진 'ㄱ'들을 모은다. 이 과정을 'clustering' 이라 한다. clustering 과정을 끝내면 비슷한 특성을 가진 'ㄱ', 들이 서로 모여 있게 되는데 이렇게 서로 모여있는 'ㄱ'들의 통계값(평균값)을 구한다. 모델링은 이렇게 'ㄱ'들의 집합, 'ㄴ'들의 집합들에 대한 통계값을 구하는 과정이다. 합성하는 과정은 바내드이 과정을 거친다. 입력된 텍스트로 부터 적정한 통계모델을 찾아내고, 통계값을 통하여 다시 원래의 파라메터를 복원한다.

복원된 파라메터를 보코더에 통과시키면 음성이 만들어지는 것이다. 알고보면 매우 간단한 원리이다.



## 포먼트

사람의 음성을 주파수 성분으로 분석하면 (공학적 관점에서 보면 time domain 을 frequency domain으로 변환하여 살펴보는것, 즉 Fourier transform) 각 주파수 대역별 에너지를 알 수 있다. 그런데 각 주파수 대역별 에너지의 분포를 그래프로 그려 보면, 특정 주파수 대역에서 에너지가 높게 나타나는 모양을 보게 된다.

![image-20200206161141776](../../../../AppData/Roaming/Typora/typora-user-images/image-20200206161141776.png)

어떤 음성의 주파수 성분을 분석한것이다. 음성뿐만 아니라 세상의 모든 신호에는 주파수 성분이 존재한다. 아래 그림과 같이 각 주파수 대역별 에너지의 분포를 나타낸것을 스펙트로그램이라 부른다.



스펙트로그램에서 세로축은 주파수 가로축은 시간축 이다. 그림의 아랫부분이 저주파대역이고 위로 올라갈수록 고주파 대역이다. 고주파 대역으로 갈수록 색이 흐려지고 어두워진다. 저주파 대역은 밝고 진하다. 

아래 갈비뼈 모양의 형태로 짙고 밝은 에너지가 나타난 곳은 음성 주인공의 목소리 특징이다. 즉 포먼트는 공명 주파수 스펙트럼에서의 피크를 의미한다.

그중 가장 아래 진하게 나타난 주파수대역을 제 1포만트라 부른다. 이것은 그 사람의 기본 주파수 라고도 부르며 f0라고도 부른다. f0는 목소리 톤이 높고 낮음을 결정하는 기본 주파수이다.